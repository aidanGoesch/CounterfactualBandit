# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_model_ar1 <- geeglm(is.resp.true  ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='ar1')
summary(resp_model_ar1)
resp_model_ex <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='exchangeable')
summary(resp_model_ex)
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_model_ar1 <- geeglm(is.resp.true  ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='ar1')
summary(resp_model_ar1)
resp_model_ex <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='exchangeable')
summary(resp_model_ex)
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
nrow(resp_df)
resp_df$sub==1
sum(resp_df$sub==1)
sum(resp_df$sub==2)
sum(resp_df$sub==3)
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_df <- resp_df[order(sub)]
sub
resp_df <- resp_df[order(resp_df$sub)]
resp_df <- resp_df[order(resp_df$sub),]
resp_df
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_model_ar1 <- geeglm(is.resp.true  ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='ar1')
summary(resp_model_ar1)
resp_model_ex <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='exchangeable')
summary(resp_model_ex)
resp_model_indep.residual
residuals(resp_model_indep)
resid(fitted.model)
resid(fitted.resp_model_indep )
resid(fitted.resp_model_indep)
resid(fitted(resp_model_indep))
fitted(resp_model_indep)
resid(resp_model_indep)
# Get pearson correlation of sample residuals
cor(resp_df$sub,resid(resp_model_indep))
summary(resp_model_indep)
summary(resp_model_ar1)
summary(resp_model_ex)
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep))
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep))
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep))
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep),plot=FALSE))
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep),plot=FALSE)
summary(resp_model_ar1)
summary(resp_model_ex)
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep),plot=FALSE)
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep),plot=FALSE)$acf[2]
#C
# GLMM with only random intercept
resp_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (1|sub),family = 'binomial',data=resp_df)
summary(resp_glmm)
#C
# GLMM with only random intercept
resp_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (1|sub),family = 'binomial',data=resp_df)
resp_glmm  <- update(resp_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
#C
# GLMM with only random intercept
ss <- getME(resp_glmm,c("theta","fixef"))
resp_glmm  <- update(resp_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(resp_glmm)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(resp_rand_slope_glmm)
resp_df$age<- as.numeric(resp_df$age)
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$age<- as.numeric(resp_df$age)
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_df <- resp_df[order(resp_df$sub),] # reorder by subject (cluster)
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_model_ar1 <- geeglm(is.resp.true  ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='ar1')
summary(resp_model_ar1)
resp_model_ex <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='exchangeable')
summary(resp_model_ex)
# Get pearson correlation of sample residuals
acf(resid(resp_model_indep),plot=FALSE)$acf[2]
#C
# GLMM with only random intercept
resp_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (1|sub),family = 'binomial',data=resp_df)
# need to do a couple more rounds of optimization to converge
ss <- getME(resp_glmm,c("theta","fixef"))
resp_glmm  <- update(resp_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(resp_glmm)
summary(model)
summary(resp_rand_slope_glmm)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
#D GLMM with random intercept and random slope
numcols <- grep("^c\\.",names(resp_df))
resp_df_scale <- resp_df
resp_df_scales[,numcols] <- scale(resp_df_scale[,numcols])
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df_scales)
resp_df_scale <- resp_df
resp_df_scale[,numcols] <- scale(resp_df_scale[,numcols])
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df_scales)
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df_scale)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer='nlminb',
optCtrl=list(maxfun=2e5)))
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df,
REML = FALSE,
control = lmerControl(
optimizer ='optimx', optCtrl=list(method='nlminb')))
install.packages("optimx")
library(optimx)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df,
REML = FALSE,
control = lmerControl(
optimizer ='optimx', optCtrl=list(method='nlminb')))
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer='nlminb',
optCtrl=list(maxfun=2e5)))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$age<- as.numeric(resp_df$age)
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_df <- resp_df[order(resp_df$sub),] # reorder by subject (cluster)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df,
REML = FALSE,
control = lmerControl(
optimizer ='optimx', optCtrl=list(method='nlminb')))
#C
# GLMM with only random intercept
resp_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (1|sub),family = 'binomial',data=resp_df)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(resp_glmm)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ log(age) + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e10)))
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ scale(age) + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ scale(age) + matern_smoke + scale(age*matern_smoke) + (matern_smoke|sub),family = 'binomial',data=resp_df)
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
#D GLMM with random intercept and random slope
resp_df$age<- as.integer(resp_df$age)
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
#D GLMM with random intercept and random slope
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_df <- resp_df[order(resp_df$sub),] # reorder by subject (cluster)
type(resp_df$age)
resp_df$age.type
resp_df
class(resp_df$age)
resp_df$age<- as.numeric(resp_df$age)
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$age<- as.numeric(resp_df$age)
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_df <- resp_df[order(resp_df$sub),] # reorder by subject (cluster)
#D GLMM with random intercept and random slope
resp_df$age <- as.factor(resp_df$age)
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
resp_rand_slope_glmm  <- update(resp_rand_slope_glmm,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(resp_rand_slope_glmm)
right_tail_prob <- 0.32
p_val <- right_tail_prob/2
p_val
chi_square_score_slope <-0.8
right_tail_prob <- 0.37
p_val <- right_tail_prob/2
p_val
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_df <- resp_df[order(resp_df$sub),] # reorder by subject (cluster)
resp_rand_slope_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (matern_smoke|sub),family = 'binomial',data=resp_df)
ss <- getME(resp_rand_slope_glmm,c("theta","fixef"))
summary(model)
summary(resp_model_indep)
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
library(lme4)
library(reshape)
library(plyr)
library(geepack)
library(optimx)
# Question3
# A analyze data using marginal GEE model w/ several working correlation structures
# get data in correct arrangement
resp <- array(c(237,10,118,6,24,3,7,3,16,2,11,1,6,2,4,2,15,4,8,2,3,2,3,1,7,3,6,4,5,11,4,7), dim=c(2,2,2,2,2))
dimnames(resp) = list(matern_smoke = c("no","yes")
,age_10 =c("no","yes")
,age_7 =c("no","yes")
,age_8 =c("no","yes")
,age_9 =c("no","yes"))
resp_df <- as.data.frame.table(resp)
resp_df  <- resp_df [rep(1:nrow(resp_df), resp_df$Freq), 1:5]
resp_df <- resp_df[c("matern_smoke","age_7","age_8","age_9","age_10")]
resp_df$sub <- 1:nrow(resp_df)
resp_df <- melt(resp_df,id=c("sub","matern_smoke"))
names(resp_df)[names(resp_df) == "variable"] <- "age"
names(resp_df)[names(resp_df) == "value"] <- "resp_illness"
resp_df$age<- revalue(resp_df$age,c("age_7"=7))
resp_df$age<- revalue(resp_df$age,c("age_8"=8))
resp_df$age<- revalue(resp_df$age,c("age_9"=9))
resp_df$age<- revalue(resp_df$age,c("age_10"=10))
resp_df$age<- as.numeric(resp_df$age)
resp_df$is.resp.true <- resp_df$resp_illness=="yes"
resp_df <- resp_df[order(resp_df$sub),] # reorder by subject (cluster)
resp_model_indep <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=sub,data=resp_df,family="binomial",corstr='independence')
summary(resp_model_indep)
resp_model_ar1 <- geeglm(is.resp.true  ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='ar1')
summary(resp_model_ar1)
resp_model_ex <- geeglm(is.resp.true ~ age + matern_smoke + age*matern_smoke,id=resp_df$sub,data=resp_df,family="binomial",corstr='exchangeable')
summary(resp_model_ex)
acf(resid(resp_model_indep),plot=FALSE)$acf[2]
#C
# GLMM with only random intercept
resp_glmm <- glmer(is.resp.true ~ age + matern_smoke + age*matern_smoke + (1|sub),family = 'binomial',data=resp_df)
install.packages("pwr2")
library(pwr2)
pwr.2way(a=2,b=2,size.A=60,size.B=60,f.A=0.6,f.B=0.6)
pwr.2way(a=2,b=2,size.A=60,size.B=60,f.A=0.6,f.B=0.6,delta.A=0.2,delta.B=0.1)
pwr.2way(2=2,size.A=60,size.B=60,f.A=0.6,f.B=0.6)
pwr.2way(2,2,size.A=60,size.B=60,f.A=0.6,f.B=0.6)
pwr.2way(2,2,0.60,0.60,f.A=0.6,f.B=0.6)
pwr.2way(2,2,0.60,0.60)
pwr.2way(2,2,0.60,0.60,1,1)
pwr.2way(2,2,0.60,0.60,0.1,0.1)
pwr.2way(2,2,60,60,0.60,0.60,0.1,0.1)
pwr.2way(2,2,60,0.6,60,0.60,0.1,0.1)
pwr.2way(2,2,60,60,0.6,0.1,0.1)
pwr.2way(2,2,60,60,0.5,0.1,0.1)
pwr.2way(2,2,60,60,60,0.1,0.1)
pwr.2way(2,2,60,0.5,60,0.1,0.1)
pwr.2way(2,2,0.5,60,60,0.1,0.1)
pwr.2way(2,2,0.5,60,60,f.A=0.6)
pwr.2way(2,2,0.5,60,60,f.A=0.6,f.B=1)
pwr.2way(2,2,0.5,60,60,f.A=0.6,f.B=0.6)
pwr.2way(2,2,0.5,60,60,f.A=0.1,f.B=0.1)
ls
read.csv('predictors.csv')
ls
read.csv('predictors.csv')
read.csv('~/Desktop/School/Grad\ School/Projects/foraging/experiment/experiment1d/data_analysis/predictors.csv')
model <- lm('prt_rel_mvt ~ cond2 + cond_3 + gal2 + gal3 + pgal2 + pgal3')
model <- lm('prt_rel_mvt ~ cond2 + cond_3 + gal2 + gal3 + pgal2 + pgal3',data = df)
model <- lm(prt_rel_mvt ~ cond2 + cond_3 + gal2 + gal3 + pgal2 + pgal3,data = df)
model <- lmer(prt_rel_mvt ~ cond2 + cond_3 + gal2 + gal3 + pgal2 + pgal3,data = df)
model <- lm(prt_rel_mvt ~ cond2,data = df)
df["prt_rel_mvt"]
df.columns()
colnames(df)
df <- read.csv('~/Desktop/School/Grad\ School/Projects/foraging/experiment/experiment1d/data_analysis/predictors.csv',check.names = FALSE)
df.columns()
df
colnames(df)
model <- lm(prt_rel_mvt ~ cond2,data = df)
df['prt_rel_mvt']
model <- lm(prt_rel_mvt ~ cond2,data = df)
df['cond2']
model <- lm(prt_rel_mvt ~ cond2,data = df)
model <- lm(prt_rel_mvt ~ cond3,data = df)
model <- lm(prt_rel_mvt ~ pgal1,data = df)
df
df <- read.csv('~/Desktop/School/Grad\ School/Projects/foraging/experiment/experiment1d/data_analysis/predictors.csv',check.names = FALSE)
df
model <- lm(prt_rel_mvt ~ pgal1,data = df)
df
model <- lm(prt_rel_mvt ~ pgal2,data = df)
model <- lm(prt_rel_mvt ~ cond2+cond3+gal2+gal3 + pgal2 +pgal3,data = df)
model
df <- read.csv('~/Desktop/School/Grad\ School/Projects/foraging/experiment/experiment1d/data_analysis/predictors.csv',check.names = FALSE)
model <- lm(prt_rel_mvt ~ cond2+cond3+gal2+gal3 + pgal2 +pgal3,data = df)
model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
model
summary(model)
df <- read.csv('~/Desktop/School/Grad\ School/Projects/foraging/experiment/experiment1d/data_analysis/predictors.csv',check.names = FALSE)
model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
res.aov <- anova_test(prt_rel_mvt ~ condition*galaxy*preced_gal)
library(rstatix)
library(tidyverse)
library(ggpubr)
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
res.aov <- aov(prt_rel_mvt ~ condition*galaxy*preced_gal)
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
res.aov <- aov(prt_rel_mvt ~ condition*galaxy*preced_gal,data=df)
df
df['prt_rel_mvt']
df['condition']
df['galaxy']
df['preced_gal']
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
res.aov <- aov(prt_rel_mvt ~ condition*galaxy*preced_gal,df)
model <- lm(prt_rel_mvt ~ condition*galaxy*preced_gal)
model <- lm(prt_rel_mvt ~ condition*galaxy*preced_gal,df=data)
help aov
aov
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
res.aov <- aov(prt_rel_mvt ~ condition,df)
df['condition']
df['prt_rel_mvt']
df['condition']
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
res.aov <- aov(prt_rel_mvt ~ condition,df)
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
aov <- aov(prt_rel_mvt ~ condition,df)
df <- read.csv('~/Desktop/School/Grad\ School/Projects/foraging/experiment/experiment1d/data_analysis/predictors.csv',check.names = FALSE)
#model <- lm(prt_rel_mvt ~ cond2+cond3+gal1+gal2 + pgal1 +pgal2,data = df)
#summary(model)
aov <- aov(prt_rel_mvt ~ condition,df)
clear all
library(tidyverse)
library(dplyr)
library(ggpubr)
library(rstatix)
library(bestNormalize)
library(gridExtra)
data <- read.csv('60feed4d6997be97f5d0dea8_reg_mat.csv')
setwd("~/Desktop/School/Grad School/Projects/context_bandits_pavlovia/data_analysis")
setwd("~/Desktop/School/Grad School/Projects/context_bandits_pavlovia/data_analysis")
data <- read.csv('60feed4d6997be97f5d0dea8_reg_mat.csv')
data
install.packages("nnet")
install.packages("nnet")
install.packages("foreign")
data$choice <- relevel(data$choice, ref = "1")
test <- multinom(prog2 ~ ses + write, data = data)
install.packages('foreign')
install.packages("https://cran.r-project.org/src/contrib/Archive/foreign/foreign_0.8-76.tar.gz")
install.packages('foreign')
